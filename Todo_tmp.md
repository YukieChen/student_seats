# 學生座位安排程式錯誤修正規劃

## 問題描述
教師設定的條件發生衝突，致使一些學生無法排入座位（例如 3 號同學），但右側欄位並未顯示這些未被安排的學生。

## 目標
修正座位安排邏輯，確保所有學生都能被正確處理，並確保未被安排的學生能夠正確顯示在 UI 上。

## 規劃步驟

1.  **理解現有程式碼結構**
    *   **閱讀 [`assets/js/main.js`](assets/js/main.js)**：了解應用程式的啟動流程和主要模組的初始化。
    *   **閱讀 [`assets/js/handlers.js`](assets/js/handlers.js)**：分析「開始安排」按鈕的事件處理邏輯，確定座位安排流程的觸發點。
    *   **閱讀 [`assets/js/algorithms.js`](assets/js/algorithms.js)**：深入理解座位安排的核心演算法，特別是處理條件約束和學生分配的部分。
    *   **閱讀 [`assets/js/ui.js`](assets/js/ui.js)**：檢查負責更新 UI 的函數，尤其是顯示座位網格和未安排學生的部分。
    *   **閱讀 [`assets/js/state.js`](assets/js/state.js)**：了解應用程式狀態（如已設定條件、學生列表、座位網格）的儲存和管理方式。

2.  **分析問題根源**
    *   **座位安排邏輯分析**：
        *   根據圖片中的條件（學生 (1,7) 必須左右相鄰，學生 1, 3, 5, 7 必須坐群組前排），分析這些條件如何影響 3 號學生的安排。
        *   檢查 [`assets/js/algorithms.js`](assets/js/algorithms.js) 中是否存在以下問題：
            *   演算法未能正確處理所有條件衝突，導致某些學生無法被安排。
            *   演算法在遇到無法安排的學生時，沒有將其正確地標記為「未安排」。
    *   **UI 顯示邏輯分析**：
        *   檢查 [`assets/js/ui.js`](assets/js/ui.js) 中負責顯示「未安排學生」的函數。
        *   確認該函數是否從座位安排演算法中接收到了完整的未安排學生列表。
        *   檢查 UI 更新邏輯是否存在錯誤，導致即使接收到列表也未能正確渲染。

3.  **實施修正**
    *   **修改 [`assets/js/algorithms.js`](assets/js/algorithms.js)**：
        *   改進座位安排演算法，使其在無法滿足所有條件時，能夠更優雅地處理衝突，例如：
            *   優先滿足某些條件，或在無法安排時將學生標記為未安排。
            *   確保演算法最終會返回一個包含所有未安排學生的列表。
    *   **修改 [`assets/js/ui.js`](assets/js/ui.js)**：
        *   確保 `updateUnassignedStudentsDisplay` 或類似函數能夠正確接收並顯示從演算法返回的未安排學生列表。
        *   如果需要，調整 UI 渲染邏輯，以確保未安排學生能夠清晰地顯示在右側欄位。

4.  **驗證與測試**
    *   在本地環境中運行應用程式。
    *   重新設定圖片中顯示的條件。
    *   執行座位安排，確認 3 號學生是否被正確處理（無論是成功安排還是被列為未安排）。
    *   檢查右側「未安排學生」欄位是否正確顯示了所有未能安排的學生。