# 學生座位安排程式 - 新增學生分群與座位綁定功能

## 目標
增加學生分組的功能，並允許將特定學生分組指定到特定的座位分群。

## 規劃步驟

### 階段一：學生分群功能實作 (獨立頁面)

1.  **UI 流程與設計 (index.html, assets/js/ui.js, assets/css/style.css)**
    *   **新增獨立的「學生分群設定」頁面：** 在進入「條件設定」頁面之前，新增一個過渡頁面或獨立區塊，讓使用者可以選擇進入「學生分群設定」或直接跳過。
    *   **「學生分群設定」頁面內容：**
        *   提供輸入欄位或介面，讓使用者可以定義學生群組，例如：「群組名稱：矮個子學生，學生編號：1, 3, 5」。
        *   顯示已定義的學生群組列表，並提供新增、編輯、刪除群組的功能。
        *   提供「儲存並繼續」或「跳過」按鈕，引導使用者進入「條件設定」頁面。
    *   更新相關 CSS 樣式以確保新 UI 元素的顯示和頁面切換的流暢性。

2.  **資料模型更新 (assets/js/state.js)**
    *   在應用程式的狀態管理中，新增一個資料結構來儲存學生群組的定義。
    *   例如，可以新增一個 `studentGroups` 物件，其中鍵為群組名稱，值為包含學生 ID 的陣列。
    *   確保學生資料模型可以與其所屬的群組關聯。

3.  **邏輯處理 (assets/js/handlers.js, assets/js/utils.js)**
    *   實作處理學生群組新增、編輯、刪除的邏輯函數。
    *   實作從 UI 讀取學生群組輸入並更新狀態的函數。
    *   實作將學生群組資料儲存到設定中（下載設定）和從設定中載入的功能。

### 階段二：學生分群與座位分群綁定功能實作

1.  **UI 設計與實作 (assets/js/ui.js, index.html)**
    *   在座位安排的網格介面中，當使用者選擇一個座位分群（例如：「前排」、「後排」）時，提供一個選項來指定一個「學生分群」到該座位分群。
    *   這可能是一個下拉選單，列出所有已定義的學生群組供選擇。
    *   在座位分群上視覺化顯示已綁定的學生群組（例如，在「前排」標籤旁顯示「矮個子學生」）。

2.  **資料模型更新 (assets/js/state.js)**
    *   在應用程式的狀態管理中，新增一個資料結構來儲存學生群組與座位分群的綁定關係。
    *   例如，可以新增一個 `groupSeatAssignments` 物件，其中鍵為座位分群 ID，值為綁定的學生群組名稱。

3.  **排位演算法修改 (assets/js/algorithms.js)**
    *   修改現有的座位安排演算法，使其能夠遵守學生分群與座位分群的綁定規則。
    *   **優先級處理：** 在安排學生時，優先將已綁定到特定座位分群的學生安排到該區域。
    *   **衝突解決：** 考慮當多個學生群組綁定到同一座位分群，或一個學生群組綁定到多個座位分群時的處理邏輯。
    *   **未綁定學生：** 確保未綁定到任何座位分群的學生仍能被合理安排。

4.  **邏輯處理與持久化 (assets/js/handlers.js, assets/js/main.js)**
    *   實作處理學生分群與座位分群綁定關係的邏輯函數。
    *   確保這些綁定關係能夠被正確地儲存（下載設定）和載入（上傳設定）。

### 階段三：排位前檢查機制

1.  **檢查邏輯實作 (assets/js/algorithms.js 或 assets/js/handlers.js)**
    *   在觸發「開始安排」按鈕之前，新增一個檢查函數。
    *   該函數應遍歷所有已定義的學生分群與座位分群的綁定關係。
    *   對於每個綁定關係，計算該學生分群中的學生總人數，以及對應座位分群的可用座位數。
    *   如果學生總人數大於可用座位數，則標記為不合理。

2.  **UI 反饋 (assets/js/ui.js)**
    *   如果檢查發現不合理的情況，則彈出警告訊息或在 UI 上顯示提示，明確告知使用者哪個學生分群無法完全安排到指定的座位分群中。
    *   提供選項讓使用者選擇是否繼續排位（可能導致部分學生無法安排），或返回修改設定。

### 額外考量

*   **錯誤處理與驗證：** 確保學生編號輸入的有效性，以及群組綁定邏輯的健壯性。
*   **使用者體驗：** 考慮如何讓使用者更直觀地理解和操作這些新功能。
*   **測試：** 針對新功能編寫測試案例，確保其正確性和穩定性。